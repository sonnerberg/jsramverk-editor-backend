(this["webpackJsonpjsramverk-editor"]=this["webpackJsonpjsramverk-editor"]||[]).push([[0],{60:function(e,t,a){},61:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(2),o=a.n(n),c=a(48),r=a.n(c),i=(a(60),a(55)),d=(a(61),a(30)),s=a(31),u=a.n(s),m=a(24),l=a(22),p=a(1),j=2500,h="RESET",f="FIELD",b="EDIT",y="SUCCESS",O="ERROR",v="CLEAR_ERROR",x="CLEAR_SUCCESS",g="UPDATE_ALL_DOCUMENTS",T="JOIN_ROOM",N="LEAVE_ROOM",R={documentId:null,editorText:"",documentName:"",allDocuments:[],success:"",error:"",joinedRooms:[]};function w(e,t){switch(t.type){case T:return Object(p.a)(Object(p.a)({},e),{},{joinedRooms:[].concat(Object(l.a)(e.joinedRooms),[t.payload])});case N:var a=Object(l.a)(e.joinedRooms).filter((function(e){return e!==t.payload}));return Object(p.a)(Object(p.a)({},e),{},{joinedRooms:a});case f:return Object(p.a)(Object(p.a)({},e),{},Object(m.a)({},t.fieldName,t.payload));case g:if(e.allDocuments.map((function(e){return e._id})).includes(t.payload._id)){var n=e.allDocuments.findIndex((function(e){return e._id===t.payload._id})),o=Object(l.a)(e.allDocuments);return o[n]=t.payload,Object(p.a)(Object(p.a)({},e),{},{allDocuments:o})}return Object(p.a)(Object(p.a)({},e),{},{allDocuments:[].concat(Object(l.a)(e.allDocuments),[t.payload])});case x:return Object(p.a)(Object(p.a)({},e),{},{success:""});case v:return Object(p.a)(Object(p.a)({},e),{},{error:""});case O:return Object(p.a)(Object(p.a)({},e),{},{error:"Document failed validation"===t.payload?"Both name and content needed":t.payload,success:""});case y:return Object(p.a)(Object(p.a)({},e),{},{success:t.payload,error:""});case b:return Object(p.a)(Object(p.a)({},e),{},{documentId:t.payload.id,editorText:t.payload.html,documentName:t.payload.name});case h:return Object(p.a)(Object(p.a)({},e),{},{documentId:"",editorText:"",documentName:"",success:""});default:return e}}var C=a(54),D=Object(C.a)("https://jsramverk-editor-pene14.azurewebsites.net/"),E=a(0),I=function(){return Object(E.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-trash",viewBox:"0 0 16 16",children:[Object(E.jsx)("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),Object(E.jsx)("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]})};function _(e){return Object(E.jsx)("button",{onClick:function(){e.dispatch({type:h}),e.dispatch({type:y,payload:"Changes trashed, new document ready"}),e.joinedRooms.forEach((function(t){e.dispatch({type:N,payload:t}),D.emit("leave",{room:t})})),setTimeout((function(){e.dispatch({type:x})}),j)},children:Object(E.jsx)(I,{})})}var k=function(){return Object(E.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-save",viewBox:"0 0 16 16",children:Object(E.jsx)("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"})})};function S(e){return Object(E.jsx)("button",{onClick:function(){!function(e){var t,a=e.documentId,n=e.documentName,o=e.editorText,c=e.dispatch,r="https://jsramverk-editor-pene14.azurewebsites.net/api/v1";a?(r="".concat(r,"/update"),t={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,name:n,html:o})}):(r="".concat(r,"/create"),t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,html:o})}),fetch(r,t).then((function(e){return e.json()})).then((function(e){return e.data?e.data.id?(c({type:f,fieldName:"documentId",payload:e.data.id}),c({type:g,payload:{_id:e.data.id,name:n,html:o}}),D.emit("join",{room:e.data.id}),c({type:T,payload:e.data.id}),D.emit("newDocument",{id:e.data.id})):(c({type:f,fieldName:"documentId",payload:e.data.value._id}),c({type:g,payload:{_id:e.data.value._id,name:n,html:o}})):(console.error(e.errors.message),c({type:O,payload:e.errors.message}),setTimeout((function(){c({type:v})}),j))})).catch((function(e){c({type:O,payload:e.message}),setTimeout((function(){c({type:v})}),j)}))}({documentName:e.documentName,editorText:e.editorText,documentId:e.documentId,dispatch:e.dispatch})},children:Object(E.jsx)(k,{})})}function L(e){return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(_,{dispatch:e.dispatch}),Object(E.jsx)(S,{documentId:e.documentId,editorText:e.editorText,documentName:e.documentName,dispatch:e.dispatch})]})}var V=function(e){var t=e.documentId,a=e.editorText,o=e.documentName,c=e.dispatch,r=e.joinedRooms,i=function(){D.emit("doc",{id:t,name:o,editorText:a}),t&&c({type:g,payload:{_id:t,name:o,html:a}})};return Object(n.useEffect)((function(){D.on("doc",(function(e){c({type:g,payload:{_id:e.id,name:e.name,html:e.editorText}}),e.hasOwnProperty("editorText")&&c({type:f,fieldName:"editorText",payload:e.editorText}),e.hasOwnProperty("name")&&c({type:f,fieldName:"documentName",payload:e.name})}))}),[c]),Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(L,{documentId:t,editorText:a,documentName:o,dispatch:c,joinedRooms:r}),Object(E.jsx)("div",{onKeyUp:i,children:Object(E.jsx)(d.CKEditor,{editor:u.a,data:o,onChange:function(e,t){!function(e){var t=e.replaceAll("<p>&nbsp;</p>","");c({type:f,fieldName:"documentName",payload:t})}(t.getData())},config:{toolbar:["bold","italic"]}})}),Object(E.jsx)("div",{onKeyUp:i,children:Object(E.jsx)(d.CKEditor,{editor:u.a,data:a,onChange:function(e,t){!function(e){c({type:f,fieldName:"editorText",payload:e})}(t.getData())}})})]})},z=a(23),A=a.n(z),M=a(52),F=a(53);function H(e){var t=e.dispatch,a=e.allDocuments,o=e.joinedRooms,c="https://jsramverk-editor-pene14.azurewebsites.net/api/v1";function r(e){return i.apply(this,arguments)}function i(){return i=Object(M.a)(A.a.mark((function e(t){var a,n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat("https://jsramverk-editor-pene14.azurewebsites.net/api/v1","/").concat(t),e.next=3,fetch(a).then((function(e){return e.json()})).then((function(e){return e.data}));case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}return Object(n.useEffect)((function(){fetch(c).then((function(e){return e.json()})).then((function(e){return e.data?t({type:f,fieldName:"allDocuments",payload:e.data}):(console.error(e.errors.message),t({type:O,payload:e.errors.message}))}))}),[t,c]),Object(n.useEffect)((function(){D.on("newDocument",(function(e){var a=e.id;r(a).then((function(e){t({type:g,payload:{_id:a,name:e.name,html:e.html}})}))}))}),[t]),Object(E.jsx)("div",{children:a.map((function(e){var a=e._id,n=e.name,c=e.html;return Object(E.jsx)("button",{style:{display:"block",cursor:"pointer",minWidth:"500px",margin:"auto"},onClick:function(e){!function(e,a){var n=a.id;a.name,a.html,e.preventDefault(),r(n).then((function(e){o.forEach((function(e){e!==n&&(t({type:N,payload:e}),D.emit("leave",{room:e}))})),o.includes(n)||(D.emit("join",{room:n}),t({type:T,payload:n})),t({type:b,payload:{id:n,name:e.name,html:e.html}}),t({type:g,payload:{_id:n,name:e.name,html:e.html}})}))}(e,{id:a,name:n,html:c})},children:Object(F.a)(n)},a)}))})}function P(e){var t=e.error;return Object(E.jsx)("div",{style:{color:"red",position:"absolute",top:"0",marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center"},children:t})}function U(e){var t=e.success;return Object(E.jsx)("div",{style:{color:"green",position:"absolute",top:"0",marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center"},children:t})}var B=function(){var e=Object(n.useReducer)(w,R),t=Object(i.a)(e,2),a=t[0],o=a.documentId,c=a.editorText,r=a.documentName,d=a.allDocuments,s=a.success,u=a.error,m=a.joinedRooms,l=t[1];return Object(E.jsxs)(E.Fragment,{children:[u?Object(E.jsx)(P,{error:u}):null,s?Object(E.jsx)(U,{success:s}):null,Object(E.jsx)(V,{documentId:o,editorText:c,documentName:r,dispatch:l,joinedRooms:m}),Object(E.jsx)(H,{dispatch:l,allDocuments:d,joinedRooms:m})]})},J=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,93)).then((function(t){var a=t.getCLS,n=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),o(e),c(e),r(e)}))};r.a.render(Object(E.jsx)(o.a.StrictMode,{children:Object(E.jsx)(B,{})}),document.getElementById("root")),J()}},[[92,1,2]]]);
//# sourceMappingURL=main.302a1f59.chunk.js.map